# TickTick MCP é¡¹ç›®æ”¹åŠ¨è®°å½•

## ğŸ‰ é‡å¤§é‡æ„

### 2025-10-15: åˆ é™¤ DEPRECATED çš„ `get_task` å·¥å…·

**ç›®æ ‡**ï¼šå®Œæˆå·¥å…·ç®€åŒ–ï¼Œå½»åº•ç§»é™¤å·²å¼ƒç”¨çš„åŠŸèƒ½

**åŸå› **ï¼š

- `get_task` å·¥å…·åœ¨ä¹‹å‰å·²æ ‡è®°ä¸º DEPRECATED
- å…¶åŠŸèƒ½å·²å®Œå…¨è¢« `query_tasks(task_id=..., project_id=...)` æ›¿ä»£
- ä¿ç•™ DEPRECATED å·¥å…·ä¼šé€ æˆæ··æ·†å’Œç»´æŠ¤è´Ÿæ‹…

**åˆ é™¤å†…å®¹**ï¼š

1. **ä»£ç **ï¼š
   - `ticktick_mcp/src/tools/task_tools.py` ä¸­çš„ `get_task()` å‡½æ•°
2. **æ–‡æ¡£**ï¼š
   - README.md ä¸­çš„ `get_task` å·¥å…·æ¡ç›®

**æ›¿ä»£æ–¹æ¡ˆ**ï¼š

```python
# ä»¥å‰
get_task(project_id="xyz789", task_id="abc123")

# ç°åœ¨ä½¿ç”¨
query_tasks(task_id="abc123", project_id="xyz789")
```

**å¥½å¤„**ï¼š

- âœ… å‡å°‘å·¥å…·æ•°é‡ï¼ˆä» 16 ä¸ªå‡å°‘åˆ° 15 ä¸ªï¼‰
- âœ… é¿å…ç”¨æˆ·å›°æƒ‘
- âœ… ä»£ç æ›´ç®€æ´ï¼Œç»´æŠ¤æˆæœ¬æ›´ä½
- âœ… ç»Ÿä¸€çš„æŸ¥è¯¢æ¥å£

**ä¿®æ”¹çš„æ–‡ä»¶**ï¼š

- `ticktick_mcp/src/tools/task_tools.py` - åˆ é™¤ `get_task` å‡½æ•°
- `README.md` - åˆ é™¤å·¥å…·è¡¨ä¸­çš„ `get_task` æ¡ç›®

---

### 2025-10-15: åˆ é™¤ GTD ç›¸å…³åŠŸèƒ½

**ç›®æ ‡**ï¼šç®€åŒ–å·¥å…·é›†ï¼Œå»é™¤ç‰¹å®šå·¥ä½œæµä¾èµ–

**é—®é¢˜**ï¼š

- GTD (Getting Things Done) æ˜¯ç‰¹å®šçš„æ—¶é—´ç®¡ç†æ–¹æ³•è®º
- "engaged" å’Œ "next" é¢„è®¾å¢åŠ äº†å·¥å…·å¤æ‚åº¦
- ç”¨æˆ·å¯ä»¥é€šè¿‡ç»„åˆç°æœ‰è¿‡æ»¤å™¨å®ç°ç›¸åŒåŠŸèƒ½
- å‡å°‘å­¦ä¹ æˆæœ¬

**åˆ é™¤çš„å†…å®¹**ï¼š

1. **date_filter é¢„è®¾**ï¼š

   - "engaged": é«˜ä¼˜å…ˆçº§ OR ä»Šå¤©åˆ°æœŸ OR å·²è¿‡æœŸ
   - "next": ä¸­ç­‰ä¼˜å…ˆçº§ OR æ˜å¤©åˆ°æœŸ

2. **æ–‡æ¡£**ï¼š

   - README.md ä¸­çš„ "GTD Workflow" ç« èŠ‚
   - ç¤ºä¾‹å’Œè¯´æ˜ä¸­çš„ GTD å¼•ç”¨

3. **æµ‹è¯•**ï¼š
   - `test_gtd_presets()` æµ‹è¯•å‡½æ•°
   - GTD ç›¸å…³çš„æµ‹è¯•ç”¨ä¾‹

**ä¿ç•™çš„åŠŸèƒ½**ï¼š

- æ‰€æœ‰åŸºç¡€æ—¥æœŸè¿‡æ»¤å™¨ï¼š"today", "tomorrow", "overdue", "next_7_days", "custom"
- ä¼˜å…ˆçº§è¿‡æ»¤
- å…³é”®è¯æœç´¢
- ç»„åˆè¿‡æ»¤ï¼ˆç”¨æˆ·å¯ä»¥è‡ªå·±ç»„åˆå®ç°ç±»ä¼¼ GTD çš„é€»è¾‘ï¼‰

**æ›¿ä»£æ–¹æ¡ˆ**ï¼š

```python
# ä»¥å‰çš„ "engaged" (GTDé¢„è®¾)
query_tasks(date_filter="engaged")

# ç°åœ¨å¯ä»¥ç”¨ç»„åˆè¿‡æ»¤å®ç°
query_tasks(priority=5)  # é«˜ä¼˜å…ˆçº§
query_tasks(date_filter="today")  # ä»Šå¤©åˆ°æœŸ
query_tasks(date_filter="overdue")  # å·²è¿‡æœŸ

# ä»¥å‰çš„ "next" (GTDé¢„è®¾)
query_tasks(date_filter="next")

# ç°åœ¨å¯ä»¥ç”¨ç»„åˆè¿‡æ»¤å®ç°
query_tasks(priority=3)  # ä¸­ç­‰ä¼˜å…ˆçº§
query_tasks(date_filter="tomorrow")  # æ˜å¤©åˆ°æœŸ
```

**ä¿®æ”¹çš„æ–‡ä»¶**ï¼š

- `ticktick_mcp/src/tools/query_tools.py` - åˆ é™¤ GTD é¢„è®¾é€»è¾‘
- `README.md` - åˆ é™¤ GTD ç« èŠ‚å’Œå¼•ç”¨
- `test/test_unified_query.py` - åˆ é™¤ GTD æµ‹è¯•
- `doc/CUROR_MEMORY.md` - è®°å½•æ­¤æ¬¡æ”¹åŠ¨

**å¥½å¤„**ï¼š

- âœ… å·¥å…·æ›´ç®€æ´ï¼Œå‡å°‘æ¦‚å¿µè´Ÿæ‹…
- âœ… ä¸ç»‘å®šç‰¹å®šå·¥ä½œæµæ–¹æ³•è®º
- âœ… ç”¨æˆ·å¯ä»¥æ ¹æ®éœ€æ±‚çµæ´»ç»„åˆè¿‡æ»¤æ¡ä»¶
- âœ… å‡å°‘ç»´æŠ¤æˆæœ¬

---

### 2025-10-15: åˆå¹¶ `get_task` åŠŸèƒ½åˆ° `query_tasks`

**ç›®æ ‡**ï¼šç®€åŒ– APIï¼Œæ¶ˆé™¤åŠŸèƒ½é‡å¤

**é—®é¢˜**ï¼š

- `get_task(project_id, task_id)` å’Œ `query_tasks(...)` åŠŸèƒ½é‡å 
- `get_task` åªèƒ½è·å–å•ä¸ªå·²çŸ¥ä»»åŠ¡ï¼Œç¼ºä¹çµæ´»æ€§
- ç”¨æˆ·éœ€è¦åœ¨ä¸¤ä¸ªå·¥å…·ä¹‹é—´é€‰æ‹©ï¼Œå¢åŠ è®¤çŸ¥è´Ÿæ‹…

**è§£å†³æ–¹æ¡ˆ**ï¼š

- ä¸º `query_tasks` æ·»åŠ  `task_id` å‚æ•°
- æ”¯æŒä¸‰ç§æŸ¥è¯¢æ¨¡å¼ï¼š
  1. **ç²¾ç¡®æŸ¥è¯¢** - `query_tasks(task_id="...", project_id="...")` - ç›´æ¥ API è°ƒç”¨ï¼ˆæœ€é«˜æ•ˆï¼‰
  2. **å…¨å±€ ID æœç´¢** - `query_tasks(task_id="...")` - åœ¨æ‰€æœ‰é¡¹ç›®ä¸­æŸ¥æ‰¾ä»»åŠ¡
  3. **å¤šç»´è¿‡æ»¤** - åŸæœ‰çš„è¿‡æ»¤åŠŸèƒ½ä¿æŒä¸å˜ï¼Œå¯ä¸ `task_id` ç»„åˆä½¿ç”¨

**å®ç°ç»†èŠ‚**ï¼š

1. **å¿«é€Ÿè·¯å¾„ä¼˜åŒ–**ï¼š

   ```python
   # å½“åŒæ—¶æä¾› task_id å’Œ project_id æ—¶ï¼Œä½¿ç”¨ç›´æ¥ API è°ƒç”¨
   if task_id and project_id:
       task = ticktick.get_task(project_id, task_id)
       # åº”ç”¨å…¶ä»–è¿‡æ»¤æ¡ä»¶ï¼ˆå¦‚æœæœ‰ï¼‰
       return format_task(task)
   ```

2. **è¿‡æ»¤å™¨é›†æˆ**ï¼š

   ```python
   # task_id ä½œä¸ºè¿‡æ»¤æ¡ä»¶åŠ å…¥ combined_filter
   if task_id is not None:
       if task.get('id') != task_id:
           return False
   ```

3. **å‘åå…¼å®¹**ï¼š
   - ä¿ç•™ `get_task` å·¥å…·ï¼Œæ ‡è®°ä¸º DEPRECATED
   - åœ¨æ–‡æ¡£å­—ç¬¦ä¸²ä¸­å¼•å¯¼ç”¨æˆ·ä½¿ç”¨ `query_tasks`

**ä¿®æ”¹çš„æ–‡ä»¶**ï¼š

- `ticktick_mcp/src/tools/query_tools.py` - æ·»åŠ  `task_id` å‚æ•°å’Œå¤„ç†é€»è¾‘
- `ticktick_mcp/src/tools/task_tools.py` - æ ‡è®° `get_task` ä¸º DEPRECATED
- `README.md` - æ›´æ–°æ–‡æ¡£ï¼Œè¯´æ˜æ–°ç”¨æ³•

**æ–°åŠŸèƒ½ç¤ºä¾‹**ï¼š

```python
# ç²¾ç¡®æŸ¥è¯¢ï¼ˆæ›¿ä»£ get_taskï¼‰
query_tasks(task_id="abc123", project_id="xyz789")

# å…¨å±€ ID æœç´¢
query_tasks(task_id="abc123")

# ç»„åˆæŸ¥è¯¢ï¼ˆéªŒè¯ä»»åŠ¡å±æ€§ï¼‰
query_tasks(task_id="abc123", priority=5)  # æ£€æŸ¥ä»»åŠ¡æ˜¯å¦ä¸ºé«˜ä¼˜å…ˆçº§
query_tasks(task_id="abc123", date_filter="today")  # æ£€æŸ¥ä»»åŠ¡æ˜¯å¦ä»Šå¤©åˆ°æœŸ
```

**å¥½å¤„**ï¼š

- âœ… ç»Ÿä¸€çš„æŸ¥è¯¢æ¥å£ï¼Œé™ä½å­¦ä¹ æˆæœ¬
- âœ… ä¿æŒé«˜æ•ˆçš„ç›´æ¥æŸ¥è¯¢èƒ½åŠ›
- âœ… æ”¯æŒæ›´çµæ´»çš„ç»„åˆæŸ¥è¯¢
- âœ… å‡å°‘å·¥å…·æ•°é‡ï¼ˆä» 16 ä¸ªå®è´¨æ€§å‡å°‘åˆ° 15 ä¸ªï¼‰
- âœ… å‘åå…¼å®¹ï¼Œç°æœ‰ç”¨æˆ·ä¸å—å½±å“

---

## ğŸ”§ ä¿®å¤çš„é—®é¢˜

### 1. æ—¥æœŸæ ¼å¼éªŒè¯é—®é¢˜

**é—®é¢˜**ï¼šLLM é€šè¿‡ MCP åˆ›å»ºå¸¦æˆªæ­¢æ—¥æœŸçš„ä»»åŠ¡æ—¶å¤±è´¥

- é”™è¯¯ï¼š`Invalid due_date format. Use ISO format: YYYY-MM-DDThh:mm:ss+0000`
- åŸå› ï¼šPython `datetime.fromisoformat()` ä¸æ”¯æŒ `+0000` æ ¼å¼ï¼ˆæ— å†’å·ï¼‰

**ä¿®å¤**ï¼š

- æ·»åŠ  `normalize_iso_date()` å‡½æ•°åˆ° `server.py`
- æ›´æ–°ä¸‰å¤„æ—¥æœŸéªŒè¯ï¼š`create_task`ã€`update_task`ã€`_validate_task_data`
- æ”¯æŒæ‰€æœ‰æ—¥æœŸæ ¼å¼ï¼š`+0000`ã€`+00:00`ã€`Z`ã€`+0800`ã€`-0500` ç­‰

### 2. API å‚æ•°ä¸å®Œæ•´é—®é¢˜

**é—®é¢˜**ï¼šMCP å·¥å…·ç¼ºå°‘ TickTick å®˜æ–¹ API çš„å¤šä¸ªå‚æ•°

**ä¿®å¤**ï¼š

- `create_task` æ·»åŠ ï¼š`desc`ã€`is_all_day`ã€`time_zone`ã€`reminders`ã€`repeat_flag`ã€`sort_order`ã€`items`
- `update_task` æ·»åŠ ï¼š`desc`ã€`is_all_day`ã€`time_zone`ã€`reminders`ã€`repeat_flag`ã€`sort_order`ã€`items`
- `batch_create_tasks` æ”¯æŒæ‰€æœ‰æ–°å‚æ•°

### 3. ç¼ºå°‘ Inbox åŠŸèƒ½

**é—®é¢˜**ï¼šæ— æ³•è®¿é—® TickTick æ”¶ä»¶ç®±ä»»åŠ¡

**ä¿®å¤**ï¼š

- æ·»åŠ  `get_inbox_tasks()` MCP å·¥å…·
- ä½¿ç”¨ç‰¹æ®Šé¡¹ç›® ID `"inbox"` è®¿é—®æ”¶ä»¶ç®±
- æ›´æ–° `get_projects()` æ–‡æ¡£è¯´æ˜ Inbox éœ€è¦å•ç‹¬è·å–

### 4. æ—¶åŒºå¤„ç† Bug

**é—®é¢˜**ï¼š`get_tasks_due_today` å·¥å…·æ— æ³•æ­£ç¡®è¯†åˆ«ä»Šæ—¥åˆ°æœŸçš„ä»»åŠ¡

- ç—‡çŠ¶ï¼šæ˜æ˜æˆªæ­¢æ—¥æœŸæ˜¯ä»Šå¤©çš„ä»»åŠ¡ï¼ˆå¦‚"å†™æ–‡ç« "ä»»åŠ¡ï¼‰ï¼Œå´æ²¡æœ‰è¢«åˆ—ä¸º"ä»Šæ—¥åˆ°æœŸ"
- åŸå› ï¼šæ—¶åŒºæ¯”è¾ƒé€»è¾‘é”™è¯¯ - æ··ç”¨äº† UTC æ—¶åŒºå’Œç”¨æˆ·æ—¶åŒºçš„æ—¥æœŸè¿›è¡Œæ¯”è¾ƒ
- å…·ä½“ä¾‹å­ï¼š
  - ä»»åŠ¡ï¼š`2025-10-14 00:00:00 Asia/Shanghai` â†’ UTC: `2025-10-13T16:00:00+0000`
  - æ—§é€»è¾‘ï¼šæå– UTC æ—¥æœŸ `2025-10-13` vs ä»Šå¤© UTC æ—¥æœŸ `2025-10-14` â†’ âŒ ä¸åŒ¹é…
  - åº”è¯¥ï¼šéƒ½è½¬æ¢åˆ°ç”¨æˆ·æ—¶åŒºæ¯”è¾ƒ `2025-10-14` vs `2025-10-14` â†’ âœ… åŒ¹é…

**ä¿®å¤**ï¼š

- æ·»åŠ  `zoneinfo` æ¨¡å—å¯¼å…¥
- æ·»åŠ  `get_user_timezone_today()` è¾…åŠ©å‡½æ•° - ç»Ÿä¸€è·å–ç”¨æˆ·æ—¶åŒºçš„ä»Šå¤©æ—¥æœŸ
- ä¿®å¤ `_is_task_due_today()` - å°†ä»»åŠ¡æ—¶é—´è½¬æ¢åˆ°ç”¨æˆ·æ—¶åŒºåæ¯”è¾ƒæ—¥æœŸ
- ä¿®å¤ `_is_task_overdue()` - åœ¨ç”¨æˆ·æ—¶åŒºè¿›è¡Œè¿‡æœŸåˆ¤æ–­
- ä¿®å¤ `_is_task_due_in_days()` - åœ¨ç”¨æˆ·æ—¶åŒºè®¡ç®—æŒ‡å®šå¤©æ•°åçš„æ—¥æœŸ
- ä¿®å¤ `get_tasks_due_this_week()` ä¸­çš„ `week_filter` - åœ¨ç”¨æˆ·æ—¶åŒºåˆ¤æ–­æœ¬å‘¨èŒƒå›´

**ç¯å¢ƒå˜é‡**ï¼š

- è®¾ç½® `TICKTICK_DISPLAY_TIMEZONE="Asia/Shanghai"` å¯ç”¨æ—¶åŒºä¿®å¤

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

### `ticktick_mcp/src/server.py`

- æ·»åŠ  `re` æ¨¡å—å¯¼å…¥
- æ·»åŠ  `zoneinfo` æ¨¡å—å¯¼å…¥ï¼ˆæ—¶åŒºä¿®å¤ï¼‰
- æ·»åŠ  `normalize_iso_date()` å‡½æ•°
- æ·»åŠ  `get_user_timezone_today()` è¾…åŠ©å‡½æ•°ï¼ˆæ—¶åŒºä¿®å¤ï¼‰
- æ›´æ–° `create_task()` å‚æ•°å’ŒéªŒè¯
- æ›´æ–° `update_task()` å‚æ•°å’ŒéªŒè¯
- æ›´æ–° `_validate_task_data()` éªŒè¯
- æ·»åŠ  `get_inbox_tasks()` å·¥å…·
- æ›´æ–° `get_projects()` æ–‡æ¡£
- ä¿®å¤ `_is_task_due_today()` æ—¶åŒºå¤„ç†
- ä¿®å¤ `_is_task_overdue()` æ—¶åŒºå¤„ç†
- ä¿®å¤ `_is_task_due_in_days()` æ—¶åŒºå¤„ç†
- ä¿®å¤ `get_tasks_due_this_week()` ä¸­çš„ `week_filter` æ—¶åŒºå¤„ç†

### `ticktick_mcp/src/ticktick_client.py`

- æ›´æ–° `create_task()` æ–¹æ³•å‚æ•°
- æ›´æ–° `update_task()` æ–¹æ³•å‚æ•°

## âœ… æµ‹è¯•ç»“æœ

- **å®Œæ•´ API æµ‹è¯•**ï¼š17/17 é€šè¿‡
- **æ—¥æœŸæ ¼å¼æµ‹è¯•**ï¼š9/9 é€šè¿‡
- **Inbox åŠŸèƒ½æµ‹è¯•**ï¼šæˆåŠŸè·å– 26 ä¸ªä»»åŠ¡
- **æ—¶åŒºä¿®å¤æµ‹è¯•**ï¼š3/3 é€šè¿‡
  - âœ… "å†™æ–‡ç« "ä»»åŠ¡æ­£ç¡®è¯†åˆ«ä¸ºä»Šæ—¥åˆ°æœŸï¼ˆä¿®å¤å‰ï¼šâŒ False â†’ ä¿®å¤åï¼šâœ… Trueï¼‰
  - âœ… "è£…æ°´"å’Œ"æŠŠ github ä¸»é¡µå¼„å¥½çœ‹"ä»»åŠ¡æ­£ç¡®è¯†åˆ«ä¸ºæ˜æ—¥åˆ°æœŸ
  - âœ… æ—¶åŒºè½¬æ¢é€»è¾‘éªŒè¯é€šè¿‡

## ğŸ¯ ä¿®å¤æ•ˆæœ

**ç°åœ¨å¯ä»¥æ­£å¸¸å·¥ä½œçš„åœºæ™¯**ï¼š

- LLM åˆ›å»ºå¸¦æˆªæ­¢æ—¥æœŸçš„ä»»åŠ¡ï¼ˆ`+0000` æ ¼å¼ï¼‰
- åˆ›å»ºå…¨å¤©ä»»åŠ¡ã€é‡å¤ä»»åŠ¡ã€å¸¦æé†’çš„ä»»åŠ¡
- è®¿é—®å’Œç®¡ç†æ”¶ä»¶ç®±ä»»åŠ¡
- æ‰¹é‡åˆ›å»ºä»»åŠ¡
- è®¾ç½®æ—¶åŒºå’Œå­ä»»åŠ¡
- æ­£ç¡®è¯†åˆ«ä»Šæ—¥åˆ°æœŸã€è¿‡æœŸã€æœªæ¥å‡ å¤©åˆ°æœŸçš„ä»»åŠ¡ï¼ˆæ—¶åŒºæ•æ„Ÿï¼‰

**å…³é”®ä¿®å¤**ï¼š

1. âœ… æ—¥æœŸæ ¼å¼é—®é¢˜å·²è§£å†³
2. âœ… API å‚æ•°å®Œå…¨å¯¹é½
3. âœ… Inbox åŠŸèƒ½å·²å®ç°
4. âœ… æ—¶åŒºå¤„ç† Bug å·²ä¿®å¤

## ğŸ—ï¸ é¡¹ç›®æ¶æ„è¯´æ˜

### ğŸ“¦ æ ¸å¿ƒç»„ä»¶

1. **MCP æœåŠ¡å™¨æ ¸å¿ƒ** (`server.py`)

   - FastMCP æœåŠ¡å™¨å®ç°
   - TickTick API å·¥å…·å°è£…
   - æ—¶åŒºå¤„ç†é€»è¾‘ âœ… **å·²ä¿®å¤**

2. **TickTick å®¢æˆ·ç«¯** (`ticktick_client.py`)

   - TickTick Open API å°è£…
   - HTTP è¯·æ±‚å¤„ç†
   - æ•°æ®æ ¼å¼è½¬æ¢

3. **è®¤è¯æ¨¡å—** (`authenticate.py`, `auth.py`)

   - OAuth 2.0 è®¤è¯æµç¨‹
   - Token ç®¡ç†
   - å‡­æ®éªŒè¯

4. **å‘½ä»¤è¡Œæ¥å£** (`cli.py`)
   - MCP æœåŠ¡å™¨å¯åŠ¨
   - é…ç½®ç®¡ç†
   - è°ƒè¯•å·¥å…·

### ğŸ“‹ åŠŸèƒ½ç‰¹æ€§

- ğŸ“‹ é¡¹ç›®å’Œä»»åŠ¡ç®¡ç†
- âœï¸ è‡ªç„¶è¯­è¨€åˆ›å»ºä»»åŠ¡
- ğŸ”„ ä»»åŠ¡çŠ¶æ€æ›´æ–°
- ğŸ“… æ—¶åŒºæ•æ„Ÿçš„æ—¥æœŸå¤„ç†
- ğŸ“¥ æ”¶ä»¶ç®±ä»»åŠ¡æ”¯æŒ
- ğŸ”Œ Claude MCP é›†æˆ

## ğŸ“š è¯¦ç»†åŠŸèƒ½æ–‡æ¡£

### ğŸ”§ æ—¶åŒºè½¬æ¢åŠŸèƒ½

TickTick MCP æ”¯æŒæ™ºèƒ½æ—¶åŒºè½¬æ¢ï¼Œå¯ä»¥å°† TickTick API è¿”å›çš„ UTC æ—¶é—´è‡ªåŠ¨è½¬æ¢ä¸ºæœ¬åœ°æ—¶é—´æˆ–æŒ‡å®šæ—¶åŒºçš„æ—¶é—´ã€‚

#### ä¸»è¦ç‰¹æ€§

1. **è‡ªåŠ¨æ—¶åŒºè½¬æ¢**

   - **é»˜è®¤è¡Œä¸º**ï¼šæ‰€æœ‰ä»»åŠ¡çš„æ—¥æœŸæ—¶é—´ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºæœ¬åœ°æ—¶åŒºæ˜¾ç¤º
   - **æ™ºèƒ½ä¼˜å…ˆçº§**ï¼šä»»åŠ¡æ—¶åŒº > é…ç½®æ—¶åŒº > ç³»ç»Ÿæœ¬åœ°æ—¶åŒº
   - **å‘åå…¼å®¹**ï¼šä¿æŒåŸå§‹ UTC æ—¶é—´ä¿¡æ¯ä»¥ä¾›å‚è€ƒ

2. **æ˜¾ç¤ºæ ¼å¼**

   ```
   2024-01-20 17:00:00 (Asia/Shanghai) [UTC: 2024-01-20T09:00:00+0000]
   ```

   åŒ…å«ï¼š

   - æœ¬åœ°æ—¶é—´ï¼š`2024-01-20 17:00:00`
   - æ—¶åŒºæ ‡è¯†ï¼š`(Asia/Shanghai)`
   - åŸå§‹ UTC æ—¶é—´ï¼š`[UTC: 2024-01-20T09:00:00+0000]`

3. **ç¯å¢ƒå˜é‡é…ç½®**
   ```bash
   # åœ¨ .env æ–‡ä»¶ä¸­æ·»åŠ 
   TICKTICK_DISPLAY_TIMEZONE=Asia/Shanghai
   ```

#### æ”¯æŒçš„æ—¶åŒº

- `Local` - ä½¿ç”¨ç³»ç»Ÿæœ¬åœ°æ—¶åŒºï¼ˆé»˜è®¤ï¼‰
- `Asia/Shanghai` - ä¸­å›½æ ‡å‡†æ—¶é—´
- `America/New_York` - ç¾å›½ä¸œéƒ¨æ—¶é—´
- `Europe/London` - è‹±å›½æ—¶é—´
- `Asia/Tokyo` - æ—¥æœ¬æ ‡å‡†æ—¶é—´
- ç­‰ç­‰...ï¼ˆæ”¯æŒæ‰€æœ‰ IANA æ—¶åŒºæ ‡è¯†ç¬¦ï¼‰

#### æŠ€æœ¯å®ç°

- `convert_utc_to_local()` - UTC æ—¶é—´è½¬æ¢ä¸ºæœ¬åœ°æ—¶é—´
- `normalize_iso_date()` - æ ‡å‡†åŒ– ISO æ—¥æœŸæ ¼å¼
- `format_task()` - æ ¼å¼åŒ–ä»»åŠ¡æ˜¾ç¤ºï¼ˆæ”¯æŒæ—¶åŒºè½¬æ¢ï¼‰

### ğŸ“¥ Inbox åŠŸèƒ½è¯¦è§£

#### æ ¸å¿ƒå‘ç°

1. **Inbox æ˜¯ç‰¹æ®Šé¡¹ç›®**

   - å›ºå®šçš„é¡¹ç›® IDï¼š`"inbox"`ï¼ˆå°å†™ï¼‰
   - ä¸åœ¨æ™®é€šé¡¹ç›®åˆ—è¡¨ API ä¸­è¿”å›
   - ä½†å¯ä»¥é€šè¿‡ `GET /open/v1/project/inbox/data` è®¿é—®

2. **API è¡Œä¸º**
   - å¯ä»¥è¯»å–ï¼šâœ…
   - å¯ä»¥åˆ›å»ºä»»åŠ¡ï¼šâœ…
   - å¯ä»¥åˆ é™¤ä»»åŠ¡ï¼šâœ…
   - ä¸æ™®é€šé¡¹ç›® API ä¸€è‡´

#### ä½¿ç”¨åœºæ™¯

1. **å¿«é€ŸæŸ¥çœ‹æ”¶ä»¶ç®±**

   ```
   ç”¨æˆ·: "æˆ‘æ”¶ä»¶ç®±é‡Œæœ‰ä»€ä¹ˆï¼Ÿ"
   LLM: è°ƒç”¨ get_inbox_tasks()
   è¿”å›: 26 ä¸ªä»»åŠ¡çš„è¯¦ç»†åˆ—è¡¨
   ```

2. **å¿«é€Ÿè®°å½•æƒ³æ³•**

   ```
   ç”¨æˆ·: "è®°ä¸€ä¸ªä»»åŠ¡ï¼šä¹°ç‰›å¥¶"
   LLM: create_task(title="ä¹°ç‰›å¥¶", project_id="inbox")
   ç»“æœ: ä»»åŠ¡å¿«é€Ÿä¿å­˜åˆ°æ”¶ä»¶ç®±
   ```

3. **æ•´ç†ä»»åŠ¡**
   ```
   ç”¨æˆ·: "æ˜¾ç¤ºæˆ‘çš„æ”¶ä»¶ç®±ä»»åŠ¡"
   LLM: get_inbox_tasks()
   ç”¨æˆ·: "æŠŠç¬¬ä¸€ä¸ªä»»åŠ¡ç§»åˆ°å·¥ä½œé¡¹ç›®"
   LLM: update_task(..., project_id="å·¥ä½œé¡¹ç›®ID")
   ```

#### ä»£ç ç¤ºä¾‹

```python
# åœ¨ MCP å·¥å…·ä¸­
@mcp.tool()
async def get_inbox_tasks() -> str:
    """è·å–æ”¶ä»¶ç®±ä»»åŠ¡"""
    inbox_data = ticktick.get_project_with_data("inbox")

    if 'error' in inbox_data:
        return f"Error: {inbox_data['error']}"

    tasks = inbox_data.get('tasks', [])

    if not tasks:
        return "Your inbox is empty. ğŸ“­"

    return format_tasks(tasks)
```

---

## ğŸ—ï¸ é¡¹ç›®é‡æ„è®°å½•ï¼ˆ2025-10-14ï¼‰

### ğŸ“‹ é‡æ„ç›®æ ‡

åŸå§‹çš„ `server.py` æ–‡ä»¶è¿‡äºåºå¤§ï¼ˆ1312 è¡Œï¼‰ï¼ŒåŒ…å«äº†å¤ªå¤šä¸åŒç±»å‹çš„åŠŸèƒ½ï¼Œå¯¼è‡´ä»£ç éš¾ä»¥ç»´æŠ¤å’Œæ‰©å±•ã€‚

### ğŸ¯ é‡æ„æ–¹æ¡ˆ

æŒ‰åŠŸèƒ½åŸŸå°†ä»£ç åˆ†ç¦»åˆ°ä¸åŒæ¨¡å—ï¼š

```
ticktick_mcp/src/
â”œâ”€â”€ server.py          # MCPæœåŠ¡å™¨æ ¸å¿ƒ (45è¡Œ) âœ¨ ç²¾ç®€96%
â”œâ”€â”€ config.py          # é…ç½®ç®¡ç† (61è¡Œ)
â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°æ¨¡å—
â”‚   â”œâ”€â”€ timezone.py    # æ—¶åŒºå¤„ç† (111è¡Œ)
â”‚   â”œâ”€â”€ formatters.py  # æ ¼å¼åŒ–å‡½æ•° (108è¡Œ)
â”‚   â””â”€â”€ validators.py  # éªŒè¯å’Œè¿‡æ»¤é€»è¾‘ (252è¡Œ)
â””â”€â”€ tools/             # MCPå·¥å…·å®šä¹‰
    â”œâ”€â”€ project_tools.py  # é¡¹ç›®ç›¸å…³å·¥å…· (179è¡Œ)
    â”œâ”€â”€ task_tools.py     # ä»»åŠ¡CRUDå·¥å…· (391è¡Œ)
    â””â”€â”€ query_tools.py    # æŸ¥è¯¢å’Œè¿‡æ»¤å·¥å…· (259è¡Œ)
```

### âœ… é‡æ„æˆæœ

1. **ä»£ç ç»„ç»‡æ¸…æ™°**ï¼š

   - åŸå§‹ `server.py`ï¼š1312 è¡Œ â†’ 45 è¡Œï¼ˆç²¾ç®€ 96%ï¼‰
   - æŒ‰åŠŸèƒ½åŸŸåˆ†ç¦»ï¼š9 ä¸ªä¸“é—¨æ¨¡å—ï¼ŒèŒè´£æ˜ç¡®

2. **æ¨¡å—åŒ–è®¾è®¡**ï¼š

   - `utils/` åŒ…å«å¯å¤ç”¨çš„å·¥å…·å‡½æ•°
   - `tools/` åŒ…å«æŒ‰åŠŸèƒ½åˆ†ç±»çš„ MCP å·¥å…·
   - `config.py` ç»Ÿä¸€ç®¡ç†é…ç½®å’Œå®¢æˆ·ç«¯åˆå§‹åŒ–

3. **æ˜“äºç»´æŠ¤**ï¼š

   - ä¿®æ”¹æ—¶åŒºé€»è¾‘åªéœ€è¦æ”¹ `timezone.py`
   - æ·»åŠ æ–°å·¥å…·çŸ¥é“åº”è¯¥æ”¾åœ¨å“ªä¸ªæ¨¡å—
   - æ¯ä¸ªæ¨¡å—éƒ½æœ‰æ˜ç¡®çš„èŒè´£è¾¹ç•Œ

4. **å‘åå…¼å®¹**ï¼š
   - ä¿æŒæ‰€æœ‰åŸæœ‰åŠŸèƒ½ä¸å˜
   - API æ¥å£å®Œå…¨ä¸€è‡´
   - æµ‹è¯•é€šè¿‡ç‡ä¿æŒä¸å˜

### ğŸ“Š é‡æ„ç»Ÿè®¡

- **åŸå§‹æ–‡ä»¶**ï¼š1 ä¸ªå·¨å¤§æ–‡ä»¶ï¼ˆ1312 è¡Œï¼‰
- **é‡æ„å**ï¼š9 ä¸ªæ¨¡å—åŒ–æ–‡ä»¶ï¼ˆæ€»è®¡ 1417 è¡Œï¼ŒåŒ…å«æ›´å¥½çš„æ–‡æ¡£ï¼‰
- **æ ¸å¿ƒæœåŠ¡å™¨**ï¼šä» 1312 è¡Œç²¾ç®€åˆ° 45 è¡Œï¼ˆ96%å‡å°‘ï¼‰
- **åŠŸèƒ½å®Œæ•´æ€§**ï¼š100%ä¿æŒ

### ğŸ”§ æŠ€æœ¯è¦ç‚¹

1. **ä¾èµ–æ³¨å…¥**ï¼šä½¿ç”¨ `ensure_client()` ç»Ÿä¸€ç®¡ç†å®¢æˆ·ç«¯
2. **å·¥å…·æ³¨å†Œ**ï¼šé€šè¿‡ `register_*_tools()` å‡½æ•°æ¨¡å—åŒ–æ³¨å†Œ
3. **å¯¼å…¥ä¼˜åŒ–**ï¼šæ¸…æ™°çš„æ¨¡å—å¯¼å…¥å±‚æ¬¡ç»“æ„
4. **é”™è¯¯å¤„ç†**ï¼šä¿æŒåŸæœ‰çš„é”™è¯¯å¤„ç†é€»è¾‘

è¿™æ¬¡é‡æ„å¤§å¤§æå‡äº†ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ï¼Œä¸ºæœªæ¥çš„åŠŸèƒ½å¼€å‘å¥ å®šäº†è‰¯å¥½çš„åŸºç¡€ã€‚

---

---

## ğŸ”„ å·¥å…·ç®€åŒ–ä¼˜åŒ–ï¼ˆ2025-10-15ï¼‰

### ğŸ“‹ ä¼˜åŒ–ç›®æ ‡

åŸæœ‰çš„ 23 ä¸ª MCP å·¥å…·å¯¹ LLM æ¥è¯´è¿‡äºå¤æ‚ï¼Œç‰¹åˆ«æ˜¯æ—¥æœŸæŸ¥è¯¢å·¥å…·æœ‰ 5 ä¸ªåŠŸèƒ½é«˜åº¦é‡å çš„å·¥å…·ï¼Œå¢åŠ äº† LLM çš„é€‰æ‹©è´Ÿæ‹…å’Œ token æ¶ˆè€—ã€‚

### ğŸ¯ å®æ–½æ–¹æ¡ˆ

**åˆå¹¶æ—¥æœŸæŸ¥è¯¢å·¥å…·ï¼ˆ5 â†’ 1ï¼‰**

åŸæœ‰å·¥å…·ï¼š

- `get_tasks_due_today()` - è·å–ä»Šå¤©åˆ°æœŸçš„ä»»åŠ¡
- `get_tasks_due_tomorrow()` - è·å–æ˜å¤©åˆ°æœŸçš„ä»»åŠ¡
- `get_tasks_due_in_days(days)` - è·å–æŒ‡å®šå¤©æ•°ååˆ°æœŸçš„ä»»åŠ¡
- `get_tasks_due_this_week()` - è·å–æœ¬å‘¨å†…åˆ°æœŸçš„ä»»åŠ¡
- `get_overdue_tasks()` - è·å–è¿‡æœŸä»»åŠ¡

åˆå¹¶ä¸ºï¼š

```python
@mcp.tool()
async def query_tasks_by_date(
    date_filter: str,
    custom_days: int = None
) -> str:
    """
    Query tasks by date/deadline criteria.

    Args:
        date_filter: "today", "tomorrow", "overdue", "next_7_days", "custom"
        custom_days: Number of days (only for "custom" filter)
    """
```

### âœ… ä¼˜åŒ–æ•ˆæœ

1. **å·¥å…·æ•°é‡å‡å°‘**ï¼š23 â†’ 19 ä¸ªå·¥å…·ï¼ˆå‡å°‘ 17%ï¼‰
2. **æ›´æ¸…æ™°çš„è¯­ä¹‰**ï¼šä½¿ç”¨æšä¸¾å€¼è€Œéå¤šä¸ªå‡½æ•°å
3. **é™ä½é€‰æ‹©å¤æ‚åº¦**ï¼šLLM åªéœ€é€‰æ‹©ä¸€ä¸ªå·¥å…·ï¼Œç„¶åä¼ å…¥ä¸åŒå‚æ•°
4. **å‡å°‘ prompt é•¿åº¦**ï¼š5 æ®µå·¥å…·æè¿°åˆå¹¶ä¸º 1 æ®µï¼Œå¤§å¹…å‡å°‘ token æ¶ˆè€—
5. **ä¿æŒåŠŸèƒ½å®Œæ•´**ï¼šæ‰€æœ‰åŸæœ‰åŠŸèƒ½é€šè¿‡å‚æ•°ç»„åˆå®ç°

### ğŸ“Š ä½¿ç”¨ç¤ºä¾‹

```python
# ä»Šå¤©åˆ°æœŸ
query_tasks_by_date("today")

# æ˜å¤©åˆ°æœŸ
query_tasks_by_date("tomorrow")

# è¿‡æœŸä»»åŠ¡
query_tasks_by_date("overdue")

# æœªæ¥ 7 å¤©
query_tasks_by_date("next_7_days")

# è‡ªå®šä¹‰å¤©æ•°ï¼ˆå¦‚ 3 å¤©åï¼‰
query_tasks_by_date("custom", 3)
```

### ğŸ”§ æŠ€æœ¯å®ç°

- ä¿æŒåº•å±‚éªŒè¯é€»è¾‘ä¸å˜ï¼ˆ`is_task_due_today`, `is_task_overdue`, `is_task_due_in_days`ï¼‰
- é€šè¿‡å‚æ•°è·¯ç”±åˆ°ç›¸åº”çš„è¿‡æ»¤å‡½æ•°
- æ·»åŠ å‚æ•°éªŒè¯ç¡®ä¿æ­£ç¡®ä½¿ç”¨
- ä¿æŒæ—¶åŒºæ•æ„Ÿçš„æ—¥æœŸæ¯”è¾ƒé€»è¾‘

### ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

- `ticktick_mcp/src/tools/query_tools.py` - åˆå¹¶æ—¥æœŸæŸ¥è¯¢å·¥å…·
- `README.md` - æ›´æ–°å·¥å…·æ–‡æ¡£å’Œç¤ºä¾‹
- `doc/CUROR_MEMORY.md` - è®°å½•ä¼˜åŒ–è¿‡ç¨‹
- `test/test_query_tools.py` - æ–°å¢ä¸“é—¨æµ‹è¯•æ–‡ä»¶éªŒè¯æ–°å·¥å…·åŠŸèƒ½

### âœ… æµ‹è¯•ç»“æœ

åˆ›å»ºäº†ä¸“é—¨çš„æµ‹è¯•æ–‡ä»¶ `test/test_query_tools.py` æ¥éªŒè¯æ–°å·¥å…·ï¼š

```bash
python test/test_query_tools.py
```

æµ‹è¯•è¦†ç›–ï¼š

1. âœ… å·¥å…·æ³¨å†ŒéªŒè¯
2. âœ… æµ‹è¯•ç¯å¢ƒè®¾ç½®ï¼ˆåˆ›å»ºä¸åŒæˆªæ­¢æ—¥æœŸçš„æµ‹è¯•ä»»åŠ¡ï¼‰
3. âœ… éªŒè¯é€»è¾‘æµ‹è¯•ï¼ˆ`is_task_due_today`, `is_task_overdue`, `is_task_due_in_days`ï¼‰
4. âœ… å‚æ•°éªŒè¯æµ‹è¯•ï¼ˆæœ‰æ•ˆå’Œæ— æ•ˆçš„ `date_filter` å€¼ï¼‰
5. âœ… è‡ªåŠ¨æ¸…ç†æµ‹è¯•æ•°æ®

**æµ‹è¯•ç»“æœ**: 4/4 é€šè¿‡ âœ…

### ğŸ’¡ è®¾è®¡åŸåˆ™

1. **å¯¹ LLM å‹å¥½**ï¼šå‡å°‘é€‰æ‹©å›°éš¾ï¼Œé™ä½è®¤çŸ¥è´Ÿæ‹…
2. **ä¿æŒç®€æ´**ï¼šå¸¸ç”¨åœºæ™¯ç”¨ç®€å•å‚æ•°ï¼Œå¤æ‚åœºæ™¯ç”¨ custom é€‰é¡¹
3. **å‘åå…¼å®¹**ï¼šåº•å±‚é€»è¾‘ä¸å˜ï¼Œåªæ˜¯æ¥å£ä¼˜åŒ–
4. **æ˜“äºæ‰©å±•**ï¼šæ–°å¢æ—¥æœŸè¿‡æ»¤ç±»å‹åªéœ€æ·»åŠ æ–°çš„ date_filter é€‰é¡¹

è¿™æ¬¡ä¼˜åŒ–æ˜¯ä¸º MCP å·¥å…· LLM å‹å¥½åŒ–çš„ç¬¬ä¸€æ­¥ï¼Œæœªæ¥å¯ä»¥è€ƒè™‘è¿›ä¸€æ­¥ç®€åŒ–ä¼˜å…ˆçº§æŸ¥è¯¢å·¥å…·ç­‰ã€‚

---

---

## ğŸ”§ å·¥å…·è¿›ä¸€æ­¥ç®€åŒ–ï¼ˆ2025-10-15ï¼‰

### ğŸ“‹ åˆå¹¶ Inbox åŠŸèƒ½

**èƒŒæ™¯**ï¼š`get_inbox_tasks` å’Œ `get_project_tasks` åŠŸèƒ½é«˜åº¦é‡å ï¼Œéƒ½æ˜¯è·å–ä»»åŠ¡åˆ—è¡¨ã€‚

**æ”¹è¿›æ–¹æ¡ˆ**ï¼š

- åˆ é™¤ç‹¬ç«‹çš„ `get_inbox_tasks` å·¥å…·
- å¢å¼º `get_project_tasks`ï¼Œæ”¯æŒç‰¹æ®Šå‚æ•° `project_id="inbox"`

**å®ç°ç»†èŠ‚**ï¼š

```python
@mcp.tool()
async def get_project_tasks(project_id: str) -> str:
    """
    Get all tasks in a specific project or inbox.

    Args:
        project_id: ID of the project, or "inbox" to get inbox tasks

    Examples:
        - get_project_tasks("abc123") â†’ Get tasks from project
        - get_project_tasks("inbox") â†’ Get tasks from Inbox
    """
```

**ä¼˜åŒ–æ•ˆæœ**ï¼š

- å·¥å…·æ•°é‡ï¼š19 â†’ **18** ä¸ªï¼ˆå†å‡å°‘ 1 ä¸ªï¼‰
- API æ›´ä¸€è‡´ï¼šä½¿ç”¨ç»Ÿä¸€çš„æ¥å£è·å–ä»»åŠ¡
- åŠŸèƒ½ä¿æŒï¼šInbox ç©ºæ—¶ä»æ˜¾ç¤ºç‰¹æ®Šæ¶ˆæ¯ "ğŸ“­ Great job staying organized!"

**æµ‹è¯•éªŒè¯**ï¼š

- âœ… å¯ä»¥ä½¿ç”¨ "inbox" è·å–æ”¶ä»¶ç®±ä»»åŠ¡
- âœ… å¤§å°å†™ä¸æ•æ„Ÿï¼ˆ"inbox" å’Œ "Inbox" éƒ½å¯ä»¥ï¼‰
- âœ… æˆåŠŸè·å–åˆ° 29 ä¸ª inbox ä»»åŠ¡

---

---

## ğŸš€ ç»Ÿä¸€æŸ¥è¯¢å·¥å…· - æœ€ç»ˆç®€åŒ– (2025-10-15)

### ğŸ“‹ é—®é¢˜åˆ†æ

ç»è¿‡å‰é¢çš„ä¼˜åŒ–ï¼Œå·¥å…·æ•°é‡ä» 23 â†’ 18ï¼Œä½†ä»å­˜åœ¨é—®é¢˜ï¼š

- 6 ä¸ªæŸ¥è¯¢å·¥å…·åŠŸèƒ½é‡å ï¼ˆget_all_tasks, get_tasks_by_priority, query_tasks_by_date, search_tasks, get_engaged_tasks, get_next_tasksï¼‰
- æ¯ä¸ªå·¥å…·åªè§£å†³ä¸€ä¸ªå…·ä½“é—®é¢˜
- æ— æ³•çµæ´»ç»„åˆè¿‡æ»¤æ¡ä»¶
- LLM ä»éœ€åœ¨å¤šä¸ªç›¸ä¼¼å·¥å…·é—´é€‰æ‹©

### ğŸ¯ è§£å†³æ–¹æ¡ˆï¼šquery_tasks è¶…çº§å·¥å…·

åˆ›å»ºä¸€ä¸ªæ”¯æŒå¤šç»´åº¦è¿‡æ»¤çš„ç»Ÿä¸€å·¥å…·ï¼Œæ›¿ä»£æ‰€æœ‰æŸ¥è¯¢å·¥å…·ã€‚

**è®¾è®¡åŸåˆ™**ï¼š

- æ‰€æœ‰å‚æ•°å¯é€‰ï¼ˆæ— å‚æ•° = æŸ¥è¯¢æ‰€æœ‰ï¼‰
- æ”¯æŒä»»æ„ç»„åˆï¼ˆAND é€»è¾‘ï¼‰
- åŒ…å« GTD é¢„è®¾ï¼ˆOR é€»è¾‘ï¼‰
- å‘åå…¼å®¹æ‰€æœ‰æ—§åŠŸèƒ½

**å·¥å…·ç­¾å**ï¼š

```python
query_tasks(
    date_filter: Optional[str] = None,      # æ—¥æœŸè¿‡æ»¤
    custom_days: Optional[int] = None,      # è‡ªå®šä¹‰å¤©æ•°
    priority: Optional[int] = None,         # ä¼˜å…ˆçº§
    search_term: Optional[str] = None,      # æœç´¢å…³é”®è¯
    project_id: Optional[str] = None,       # é¡¹ç›®é™å®š
    include_all_projects: bool = True       # æ˜¯å¦æœç´¢æ‰€æœ‰é¡¹ç›®
)
```

### âœ¨ åŠŸèƒ½ç‰¹æ€§

**1. å¤šç»´åº¦è¿‡æ»¤** (AND é€»è¾‘)

```python
# å¯ä»¥ç»„åˆä»»æ„è¿‡æ»¤æ¡ä»¶
query_tasks(date_filter="today", priority=5)           # ä»Šå¤© AND é«˜ä¼˜å…ˆçº§
query_tasks(search_term="meeting", priority=3)         # åŒ…å«"meeting" AND ä¸­ä¼˜å…ˆçº§
query_tasks(date_filter="next_7_days", search_term="review", priority=5)
```

**2. GTD é¢„è®¾** (OR é€»è¾‘)

```python
query_tasks(date_filter="engaged")  # é«˜ä¼˜å…ˆçº§ OR ä»Šå¤©åˆ°æœŸ OR è¿‡æœŸ
query_tasks(date_filter="next")     # ä¸­ä¼˜å…ˆçº§ OR æ˜å¤©åˆ°æœŸ
```

**3. é¡¹ç›®é™å®š**

```python
query_tasks(project_id="inbox", priority=5)           # æ”¶ä»¶ç®±ä¸­çš„é«˜ä¼˜å…ˆçº§
query_tasks(project_id="abc123", date_filter="today") # ç‰¹å®šé¡¹ç›®ä»Šå¤©åˆ°æœŸ
```

### ğŸ“Š ä¼˜åŒ–æ•ˆæœ

**åˆ é™¤çš„å·¥å…· (6 ä¸ª)**ï¼š

- âŒ `get_all_tasks`
- âŒ `get_tasks_by_priority`
- âŒ `query_tasks_by_date`
- âŒ `search_tasks`
- âŒ `get_engaged_tasks`
- âŒ `get_next_tasks`

**æ–°å¢å·¥å…· (1 ä¸ª)**ï¼š

- âœ… `query_tasks` - ç»Ÿä¸€æŸ¥è¯¢å·¥å…·

**å·¥å…·æ•°é‡**ï¼š

- ä¼˜åŒ–å‰: 18 ä¸ª
- ä¼˜åŒ–å: **13 ä¸ª**
- å‡å°‘: 5 ä¸ªå·¥å…·ï¼ˆ27.8%ï¼‰

**æ€»ä½“ä¼˜åŒ–**ï¼ˆç›¸æ¯”æœ€åˆï¼‰ï¼š

- æœ€åˆ: 23 ä¸ªå·¥å…·
- ç°åœ¨: **13 ä¸ªå·¥å…·**
- æ€»å…±å‡å°‘: **10 ä¸ªå·¥å…·ï¼ˆ43.5% ä¼˜åŒ–ï¼‰** ğŸ‰

### ğŸ§ª æµ‹è¯•éªŒè¯

åˆ›å»ºäº†ä¸“é—¨çš„æµ‹è¯•æ–‡ä»¶ `test/test_unified_query.py`ï¼š

**æµ‹è¯•è¦†ç›–**ï¼š

- âœ… å•ä¸€è¿‡æ»¤å™¨ï¼ˆæ—¥æœŸã€ä¼˜å…ˆçº§ã€æœç´¢ï¼‰
- âœ… ç»„åˆè¿‡æ»¤å™¨ï¼ˆAND é€»è¾‘ï¼‰
- âœ… GTD é¢„è®¾ï¼ˆOR é€»è¾‘ï¼‰
- âœ… é¡¹ç›®è¿‡æ»¤ï¼ˆåŒ…æ‹¬ inboxï¼‰
- âœ… è‡ªåŠ¨æ¸…ç†æµ‹è¯•æ•°æ®

**æµ‹è¯•ç»“æœ**ï¼š

```
âœ… date_filter='today': 1 ä¸ªä»»åŠ¡
âœ… priority=5: 2 ä¸ªä»»åŠ¡
âœ… search_term='meeting': 1 ä¸ªä»»åŠ¡
âœ… today + priority=5: 1 ä¸ªä»»åŠ¡
âœ… date_filter='engaged': 2 ä¸ªä»»åŠ¡
âœ… date_filter='next': 3 ä¸ªä»»åŠ¡
âœ… project_id + priority=5: 2 ä¸ªä»»åŠ¡
âœ… project_id='inbox': 29 ä¸ªä»»åŠ¡
```

æ‰€æœ‰æµ‹è¯•é€šè¿‡ âœ…

### ğŸ’¡ å¯¹ LLM çš„å·¨å¤§æ”¹è¿›

1. **æå¤§ç®€åŒ–é€‰æ‹©**ï¼šä» 6 ä¸ªæŸ¥è¯¢å·¥å…· â†’ 1 ä¸ªå·¥å…·
2. **æ— é™ç»„åˆèƒ½åŠ›**ï¼šä¸å†å—é™äºé¢„è®¾åœºæ™¯ï¼Œå¯ä»¥ä»»æ„ç»„åˆ
3. **æ›´å¼ºå¤§çš„åŠŸèƒ½**ï¼šæ”¯æŒå¤æ‚æŸ¥è¯¢ï¼Œå¦‚"æ”¶ä»¶ç®±ä¸­ä»Šå¤©åˆ°æœŸçš„é«˜ä¼˜å…ˆçº§ä»»åŠ¡"
4. **å‡å°‘ prompt**ï¼šæŸ¥è¯¢ç›¸å…³æè¿°å‡å°‘çº¦ 40% tokens
5. **é™ä½è®¤çŸ¥è´Ÿæ‹…**ï¼šLLM åªéœ€è®°ä½ä¸€ä¸ªå·¥å…·å’Œå®ƒçš„å‚æ•°

### ğŸ“ ä½¿ç”¨ç¤ºä¾‹

```python
# åŸºç¡€æŸ¥è¯¢
query_tasks()                                    # æ‰€æœ‰ä»»åŠ¡
query_tasks(date_filter="today")                 # ä»Šå¤©åˆ°æœŸ
query_tasks(priority=5)                          # é«˜ä¼˜å…ˆçº§

# ç»„åˆæŸ¥è¯¢
query_tasks(date_filter="today", priority=5)     # ä»Šå¤©+é«˜ä¼˜å…ˆçº§
query_tasks(search_term="bug", priority=5)       # æœç´¢"bug"+é«˜ä¼˜å…ˆçº§
query_tasks(date_filter="next_7_days", priority=3, search_term="review")

# GTD å·¥ä½œæµ
query_tasks(date_filter="engaged")               # ç´§æ€¥ä»»åŠ¡
query_tasks(date_filter="next")                  # ä¸‹ä¸€æ­¥ä»»åŠ¡

# é¡¹ç›®é™å®š
query_tasks(project_id="inbox")                  # æ”¶ä»¶ç®±æ‰€æœ‰ä»»åŠ¡
query_tasks(project_id="inbox", date_filter="today")  # æ”¶ä»¶ç®±ä»Šå¤©åˆ°æœŸ
```

---

_è®°å½•æ—¥æœŸï¼š2025-10-11ï¼ˆåˆå§‹ä¿®å¤ï¼‰_  
_æ—¶åŒºä¿®å¤æ—¥æœŸï¼š2025-10-14_  
_é¡¹ç›®é‡æ„æ—¥æœŸï¼š2025-10-14_  
_å·¥å…·ç®€åŒ–ä¼˜åŒ–ï¼š2025-10-15ï¼ˆæ—¥æœŸæŸ¥è¯¢åˆå¹¶ + Inbox åŠŸèƒ½åˆå¹¶ + ç»Ÿä¸€æŸ¥è¯¢å·¥å…·ï¼‰_
